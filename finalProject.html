<!DOCTYPE html>
<html>
  <head>
	<title> She's Not Here </title>
  </head>
  <body>
    <div id="game"></div>
    <script type="text/javascript" src="https://rawgithub.com/craftyjs/Crafty/release/dist/crafty-min.js"></script>
    
	<script>
		Crafty.init(800,600, document.getElementById('game'));	//initiate crafty & window
		
		//template for solids
		Crafty.c('Solid', {
			init: function() {
				this.requires('2D, Canvas, Grid, Color');
				this.color('black');
			},
		});
		
		//template for Player-controlled sprite
		Crafty.c('playerC', {
			init: function() {
				this.requires('2D, Canvas, Twoway, Gravity, Color, Collision')
					.twoway(4,7)
					.color('black')
					.gravity('Solid')
					.bind('Moved', function(p) {
						if (this.hit('Solid')){
							this.attr({x: p.x});
						}
						//dir = this.
					});
			}
		});
		
		//template for projectiles (both player & enemy)
		Crafty.c('projectile', {
			init: function(){
				this.requires('2D, DOM, Color, Collision')
					.color('green')
					.bind('EnterFrame', function(){
						this.x += this.xspeed;
						if(this._x < this._x-Crafty.viewport.width || this._x > this._x+Crafty.viewport.width || this._y < this.y-Crafty.viewport.height || this._y > this.y+Crafty.viewport.height || this.hit('Solid')) {
							this.destroy();
						}
					})
			}
		});
		
		/** LEVEL SCREENS **/
		//start screen
		Crafty.defineScene('Start', function(){
			Crafty.background('url(http://i483.photobucket.com/albums/rr198/F12anky/starrynightsky1.jpg)');
			Crafty.e('2D, DOM, Canvas, Text')
				.attr({x:100, y:100})
				.text("She's Not Here").unselectable()
				.textColor('white')
				.textFont({type:'italic', size:'100px', family:'Cursive', weight:'bold'});
		});
		
		//level 1 screen
		Crafty.defineScene('level1', function(){
			Crafty.background('#1D1D1F');
			//platforms
			Crafty.e('Solid').attr({x: 0, y: 550, w: 1600, h: 50});
			Crafty.e('Solid').attr({x: 0, y: 420, w: 400, h: 20});
			//border
			Crafty.e('Solid').attr({x: 0, y: 0, w: 30, h: 600});	//W side
			Crafty.e('Solid').attr({x: 770, y: 300, w: 30, h: 300});	//E side 
		});
		
		//triggered when 'start' button is pressed
		Crafty.enterScene('level1');
		
		//initiates player
		var player = Crafty.e('playerC').attr({x: 200, y: 520, w: 30, h: 50});
		Crafty.viewport.follow(player,0,0);			//camera to follow player
		
		/** ABILITIES **/
		//double-jump
		player.bind('KeyDown', function(e) {
			if (!this._falling && e.key === Crafty.keys.UP_ARROW) {
				this._canJumpAgain = true;} 
			else if (this._canJumpAgain && e.key === Crafty.keys.UP_ARROW) {
				this._up = true;
				this._gy = 0;
				this._canJumpAgain = false;
			}
		});
		
		//poison bullets
		player.bind('KeyDown', function(e){
			if(e.key === Crafty.keys.SPACE){
				Crafty.e('projectile').attr({x: this._x, y: this._y, w: 10, h: 10, xspeed: 10});
			}
		});

    </script>
  </body>
</html>